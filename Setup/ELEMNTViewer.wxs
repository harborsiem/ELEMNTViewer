<?xml version="1.0" encoding="UTF-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: 
    lightArgs: "<projectname>.wixobj" -out "<projectname>.msi" -ext WixUtilExtension -ext WixUIExtension -ext WixNetFxExtension
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="E0A96EE1-71AA-4EA2-9F60-3CB4F2E43BCC" Name="ELEMNTViewer" Language="1033" Version="1.0.0.0" Manufacturer="Harbor" UpgradeCode="E41DD83A-EF9F-48B3-B987-927C001F6688">
    <Package InstallerVersion="301" Compressed="yes" Platform="x86" InstallScope="perMachine" Description="ELEMNTViewer" Comments="ELEMNTViewer Install" />

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <Media Id="1" Cabinet="Data.cab" EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="ELEMNTViewer Setup" Level="1">
      <ComponentGroupRef Id="ProductComponents1" />
      <ComponentGroupRef Id="ProductComponents2" />
    </Feature>
    <UI />
    <UIRef Id="WixUI_Minimal" />
    <PropertyRef Id="WIX_IS_NETFRAMEWORK_461_OR_LATER_INSTALLED" />
    <Condition Message="This application requires .NET Framework 4.6.1. Please install the .NET Framework then run this installer again."><![CDATA[Installed OR WIX_IS_NETFRAMEWORK_461_OR_LATER_INSTALLED]]></Condition>
    <Icon Id="MainIcon.ico" SourceFile="..\ELEMNTViewer\Resources\AppIcon.ico" />
    <Property Id="ARPPRODUCTICON" Value="MainIcon.ico" />
    <WixVariable Id="WixUILicenseRtf" Value="MIT_License.rtf" />
  </Product>

  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="Di.INSTALLDIR" Name="ELEMNTViewer">
        </Directory>
      </Directory>
      <Directory Id="ProgramMenuFolder">
      </Directory>
    </Directory>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="ProductComponents1" Directory="Di.INSTALLDIR">
      <Component Id="C.ELEMNTViewerExe" Guid="DA142E1C-78BE-4FE9-82D1-91978CDF8CDB">
        <File Id="Fi.ELEMNTViewerExe" Name="ELEMNTViewer.exe" Source="..\ELEMNTViewer\bin\Release\ELEMNTViewer.exe" KeyPath="yes" Checksum="yes" />
        <File Id="Fi.ELEMNTViewerConfig" Name="ELEMNTViewer.exe.config" Source="..\ELEMNTViewer\bin\Release\ELEMNTViewer.exe.config" Checksum="yes" />
        <File Id="Fi.FitDll" Name="Fit.dll" Source="..\ELEMNTViewer\Resources\Fit.dll" Checksum="yes" />
        <File Id="Fi.Ribbon" Name="Ribbon.dll" Source="..\ELEMNTViewer\Resources\Ribbon.dll" Checksum="yes" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="ProductComponents2" Directory="ProgramMenuFolder">
      <Component Id="C.AppMenu" Guid="31676EDB-CA37-42F6-B415-179E5D7EC393">
        <Shortcut Id="ApplicationStartMenuShortcut" Name="ELEMNTViewer" Target="[!Fi.ELEMNTViewerExe]" WorkingDirectory="Di.INSTALLDIR" Icon="MainIcon.ico" IconIndex="0" />
        <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Value="" Type="string" KeyPath="yes" />
      </Component>
    </ComponentGroup>
  </Fragment>
  
</Wix>